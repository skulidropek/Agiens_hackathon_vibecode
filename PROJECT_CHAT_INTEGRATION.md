# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–∞—Ç–æ–≤ —Å –ø—Ä–æ–µ–∫—Ç–∞–º–∏

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ —á–∞—Ç–æ–≤ —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ —Å —Å–∏—Å—Ç–µ–º–æ–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞–º–∏. **–í—Å–µ —á–∞—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –≤ —Ä–∞–º–∫–∞—Ö –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞**.

## –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### üîÑ –ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Frontend ‚Üí Select Project ‚Üí Activate Project ‚Üí Chat Session (Project-bound)
                                                      ‚Üì
                                            AI Context (Project files only)
```

### üìÅ Project-aware —Ñ–∞–π–ª–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

**–ù–æ–≤—ã–µ endpoints:**
- `GET /api/files/project` - —Ñ–∞–π–ª—ã –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
- `GET /api/files/project/:path` - —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞
- `POST /api/files/project/:path` - —Å–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ –ø—Ä–æ–µ–∫—Ç–µ
- `DELETE /api/files/project/:path` - —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞
- `GET /api/files/project-stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

### üí¨ Project-bound —á–∞—Ç—ã

**–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ endpoints:**
- `POST /api/chat/sessions` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏ —Ç—Ä–µ–±—É–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
- –í—Å–µ —Å–µ—Å—Å–∏–∏ —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∞—Ç `projectId`
- AI –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤–∫–ª—é—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª—ã –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

## –ù–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### ProjectChatService

–û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —á–∞—Ç–æ–≤ —Å –ø—Ä–æ–µ–∫—Ç–∞–º–∏:

```typescript
class ProjectChatService {
  // –ü–æ–ª—É—á–∏—Ç—å AI –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
  async getAIContext(): Promise<AIContext>
  
  // –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø—É—Ç—å –≤ —Ä–∞–º–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞
  getSecureProjectPath(relativePath: string): string | null
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –ø—É—Ç–∏ –∫ –ø—Ä–æ–µ–∫—Ç—É
  isPathInActiveProject(absolutePath: string): boolean
  
  // –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞
  createProjectSession(userId: string, conversationId: string): Session | null
  
  // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
  async getProjectStats(): Promise<ProjectStats>
}
```

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã

```typescript
interface ChatMessage {
  // ... existing fields
  projectId?: string; // –ü—Ä–∏–≤—è–∑–∫–∞ –∫ –ø—Ä–æ–µ–∫—Ç—É
}

interface Session {
  // ... existing fields  
  projectId?: string; // –ü—Ä–∏–≤—è–∑–∫–∞ –∫ –ø—Ä–æ–µ–∫—Ç—É
}

interface AIContext {
  projectId?: string;     // ID –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
  projectName?: string;   // –ò–º—è –ø—Ä–æ–µ–∫—Ç–∞
  projectPath?: string;   // –ü—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É
  // ... existing fields
}
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### Path Security
- –í—Å–µ –ø—É—Ç–∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è –∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è
- –ë–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –ø–æ–ø—ã—Ç–∫–∏ –≤—ã–π—Ç–∏ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ (`../../../etc/passwd`)
- –§–∞–π–ª–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã –∞–∫—Ç–∏–≤–Ω—ã–º –ø—Ä–æ–µ–∫—Ç–æ–º

### Project Isolation
- –ö–∞–∂–¥—ã–π —á–∞—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å —Ñ–∞–π–ª–∞–º–∏ —Å–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
- AI –∫–æ–Ω—Ç–µ–∫—Å—Ç –Ω–µ –≤–∫–ª—é—á–∞–µ—Ç —Ñ–∞–π–ª—ã –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
- –ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è –º–µ–∂–¥—É –ø—Ä–æ–µ–∫—Ç–∞–º–∏

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –ø—Ä–æ–µ–∫—Ç
curl -X PUT http://localhost:3000/api/projects/PROJECT_ID/activate
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Ç-—Å–µ—Å—Å–∏–∏

```bash
# –°–æ–∑–¥–∞–µ–º —Å–µ—Å—Å–∏—é (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç—Å—è –∫ –∞–∫—Ç–∏–≤–Ω–æ–º—É –ø—Ä–æ–µ–∫—Ç—É)
curl -X POST http://localhost:3000/api/chat/sessions \
  -H "Content-Type: application/json" \
  -d '{"userId": "user123"}'

# –û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç projectId
{
  "success": true,
  "data": {
    "id": "session-id",
    "projectId": "project-id",
    "userId": "user123",
    "conversationId": "conv-id",
    "isActive": true
  }
}
```

### 3. –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –ü–æ–ª—É—á–∏—Ç—å —Ñ–∞–π–ª—ã –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
curl http://localhost:3000/api/files/project

# –ü–æ–ª—É—á–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞
curl http://localhost:3000/api/files/project/src/index.js

# –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –≤ –ø—Ä–æ–µ–∫—Ç–µ
curl -X POST http://localhost:3000/api/files/project/new-file.js \
  -H "Content-Type: application/json" \
  -d '{"content": "console.log(\"Hello from project!\");"}'

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
curl http://localhost:3000/api/files/project-stats
```

## –ú–∏–≥—Ä–∞—Ü–∏—è

### –î–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

1. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞** –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º —á–∞—Ç-—Å–µ—Å—Å–∏–∏
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö endpoints** –¥–ª—è —Ñ–∞–π–ª–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

### –î–ª—è AI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

1. **AI –∫–æ–Ω—Ç–µ–∫—Å—Ç** —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç–∞
2. **–§–∞–π–ª—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã** –∞–∫—Ç–∏–≤–Ω—ã–º –ø—Ä–æ–µ–∫—Ç–æ–º
3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º –≤–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞

## –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- –°—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª–æ–≤—ã–µ endpoints (`/api/files/*`) –æ—Å—Ç–∞—é—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏
- –ß–∞—Ç-—Å–µ—Å—Å–∏–∏ –±–µ–∑ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `ProjectChatService` –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- Graceful degradation –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Unit —Ç–µ—Å—Ç—ã
- `ProjectChatService` - –ø–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—É—Ç–µ–π
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–π
- AI –∫–æ–Ω—Ç–µ–∫—Å—Ç

### Integration —Ç–µ—Å—Ç—ã
- Project-aware —Ñ–∞–π–ª–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- –°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Ç-—Å–µ—Å—Å–∏–π —Å –ø—Ä–æ–µ–∫—Ç–∞–º–∏
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤

## –ü—Ä–∏–º–µ—Ä—ã

### –ü–æ–ª–Ω—ã–π workflow

```bash
# 1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
curl -X POST http://localhost:3000/api/projects \
  -H "Content-Type: application/json" \
  -d '{"name": "my-app", "type": "local"}'

# 2. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
curl -X PUT http://localhost:3000/api/projects/PROJECT_ID/activate

# 3. –°–æ–∑–¥–∞—Ç—å —á–∞—Ç-—Å–µ—Å—Å–∏—é
curl -X POST http://localhost:3000/api/chat/sessions \
  -H "Content-Type: application/json" \
  -d '{"userId": "developer"}'

# 4. –ü–æ–ª—É—á–∏—Ç—å —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞
curl http://localhost:3000/api/files/project

# 5. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –≤ –ø—Ä–æ–µ–∫—Ç–µ
curl -X POST http://localhost:3000/api/files/project/app.js \
  -H "Content-Type: application/json" \
  -d '{"content": "// My app code"}'

# 6. –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
curl http://localhost:3000/api/files/project-stats
```

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

```bash
curl http://localhost:3000/api/projects/active
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Å—Å–∏–π

```bash
curl http://localhost:3000/api/chat/sessions
```

### –õ–æ–≥–∏

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å —É–∫–∞–∑–∞–Ω–∏–µ–º `projectId`:

```
[INFO] New chat session created { sessionId, conversationId, userId, projectId }
[INFO] Fetching project files list { projectName: "my-app" }
[INFO] Creating/updating project file { path: "/project/path/file.js" }
```

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–ß–∞—Ç—ã —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç –¢–û–õ–¨–ö–û —Å –ø—Ä–æ–µ–∫—Ç–∞–º–∏:**
- ‚úÖ –ö–∞–∂–¥—ã–π —á–∞—Ç –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∞–∫—Ç–∏–≤–Ω–æ–º—É –ø—Ä–æ–µ–∫—Ç—É
- ‚úÖ AI –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª—ã —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ –ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è –º–µ–∂–¥—É –ø—Ä–æ–µ–∫—Ç–∞–º–∏
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ñ–∞–π–ª–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- ‚úÖ –ü–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

*–°–æ–∑–¥–∞–Ω–æ AGI Assistant - –≤–∞—à–∏–º –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–º –ø–æ–º–æ—â–Ω–∏–∫–æ–º –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ* 